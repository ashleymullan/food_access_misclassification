width_hint = 0.4) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "t",
width_hint = 0.4,
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "tr",
width_hint = 0.4,
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "tr",
width_hint = 0.2,
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(5, "cm"),
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(1, "cm"),
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = "black", "black") +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
geom_sf(data = county, aes(geometry = geometry),
color = "green", fill = NA, size = 25) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = c("black", "black")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
colors()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
plot_unit = "mi",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(6, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(7, "mm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(2, "cm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(1.5, "cm"),
unit_category = "imperial",
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(1.5, "cm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(1, "cm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(0.75, "cm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
plot_unit = "mi",
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
scalebar(location = "bottomright", dist = 4,
dist_unit = "mi", transform = TRUE,  model = "WGS84") +
#ggspatial::annotation_scale(location = "br",
#                            width_hint = 0.2,
#                            plot_unit = "mi",
#                            pad_y = unit(2, "cm"),
#                            pad_x = unit(6, "mm"),
#                            bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
library(ggspatial)
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
scalebar(location = "bottomright", dist = 4,
dist_unit = "mi", transform = TRUE,  model = "WGS84") +
#ggspatial::annotation_scale(location = "br",
#                            width_hint = 0.2,
#                            plot_unit = "mi",
#                            pad_y = unit(2, "cm"),
#                            pad_x = unit(6, "mm"),
#                            bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
width_hint = 0.2,
unit_category = "imperial",
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
ggspatial::annotation_scale(location = "br",
unit_category = "imperial",
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
?geom_sf
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry),
default_crs = sf::st_crs(4326)) +
ggspatial::annotation_scale(location = "br",
unit_category = "imperial",
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
data |> left_join(tracts) |>
ggplot() +
geom_sf(aes(geometry = geometry),
color = "black", fill = NA, size = 25) +
geom_sf(aes(fill = as.factor(col_half), geometry = geometry)) +
coord_sf(default_crs = sf::st_crs(4326)) +
ggspatial::annotation_scale(location = "br",
unit_category = "imperial",
pad_y = unit(2, "cm"),
pad_x = unit(6, "mm"),
bar_cols = c("slategray1", "slategray4")) +
theme_void() +
theme(legend.position = "none", #blue neither, gold wrong, black both
plot.title = element_text(hjust = 0.5, size = 10)) +
labs(fill = "", title = "") +
theme(plot.margin = margin(2, 2, 2, 2, "mm")) +
scale_fill_colorblind()
#| echo: false
#| results: hide
#| message: false
library(foreign)
library(rms)
library(survival)
library(survminer)
psa <- read.dta(paste0("/Users/ashleymullan/Documents/Vanderbilt/Coursework/",
"Spring-2025/modern-regression/hw/psa.dta"))
psa$nadirpsa <- psa$dirpsa
psa <- psa |> mutate(inrem = ifelse(inrem == "yes", FALSE, TRUE))
surv <- survfit(Surv(obstime, inrem) ~ bss, data = psa)
ggsurvplot(surv, data = psa, conf.int = TRUE) +
labs(title = "Time to Relapse in Bone Score Groups")
summary(surv, times = 24)
surv
psa <- psa |> mutate(bss3 = ifelse(bss == 3, 1, 0))
surv_bin <- survfit(Surv(obstime, inrem) ~ bss3, data = psa)
ggsurvplot(surv_bin, data = psa, conf.int = TRUE) +
labs(title = "Time to Relapse in Dichotomized Bone Score")
survdiff(Surv(obstime, inrem) ~ bss3, data = psa)
coxph(Surv(obstime, inrem) ~ bss3, data = psa, robust=TRUE)
c(exp(1.0977 - 1.96 * 0.3732),exp(1.0977 + 1.96 * 0.3732))
coxph(Surv(obstime, inrem) ~ bss, data = psa, robust=TRUE)
.9328 * 2
exp(0.9328 * 2) #point estimate, continuous model
exp(2*(0.9328 + 1.96 * 0.3121))
c(exp(2*(0.9328 - 1.96 * 0.3121)),exp(2*(0.9328 + 1.96 * 0.3121))) #bounds, continuous model
psa <- psa |> mutate(hi_psa = ifelse(nadirpsa >= 1, 1, 0))
surv_psa <- survfit(Surv(obstime, inrem) ~ hi_psa, data = psa)
ggsurvplot(surv_psa, data = psa, conf.int = TRUE) +
labs(title = "Time to Relapse in Dichotomized PSA")
surv_psa
ggsurvplot(surv_psa, data = psa, conf.int = TRUE) +
labs(title = "Time to Relapse in Dichotomized PSA")
coxph(Surv(obstime, inrem) ~ nadirpsa, data = psa, robust=TRUE)
exp(0.015717 * 10) #point est
c(exp(10*(0.015717 - 1.96 * 0.003671)),
exp(10*(0.015717 + 1.96 * 0.003671)))
psa <- psa |> mutate(lognadirpsa = log2(nadirpsa))
coxph(Surv(obstime, inrem) ~ lognadirpsa, data = psa, robust = TRUE)
